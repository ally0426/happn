<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id="buttons">
        <button id="weather">Weather</button>
        <button id="weather16">Weather16</button>
    </div>

    <div id="description">

    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">


        //Single Day Forecast
        $("#weather").on("click", function() {

            // This is our API key
            var weatherAPIKey = "166a433c57516f51dfab1f7edaed8413";

            var userCity = "minneapolis";

            // Here we are building the URL we need to query the database(Current Day)
            var weatherURLShort =    "https://api.openweathermap.org/data/2.5/weather?q=" +
                                userCity + "&units=imperial&appid=" + weatherAPIKey;
            
            // Here we run our AJAX call to the OpenWeatherMap API
            $.ajax ({
            url: weatherURLShort,
            method: "GET"
            })
                
            // We store all of the retrieved data inside of an object called "response"
            .then(function(response) {
                // Log the queryURL
                console.log("weatherURL: " + weatherURLShort);
                // Log the resulting object
                console.log(response);
                
                var results = response.main;
                var city = response.name
                    console.log("city: " + city);
              
                var temp = Math.floor(results.temp);
                        console.log("temp: " + temp + "째 F");

                var weather = response.weather;

                for (var i = 0; i < weather.length; i++) {

                    var description = weather[i].main;
                    console.log("desc: " + description);

                    var image = weather[i].icon;
                    console.log(image);

                    var weatherDiv = $("<div>");
                    var weatherImage = $("<img>");
                    var weatherCity = $("<p>").text(city);
                    
                    weatherImage.attr("src", "http://openweathermap.org/img/w/" + image + ".png")

                    $("#description").append(weatherDiv);
                    
                    weatherDiv.append(weatherImage);

                }

                    weatherDiv.append(weatherCity);

                    var weatherTemp = $("<p>").text("Temperature: " + temp + "째 F");
                    weatherDiv.append(weatherTemp);   
            });
        });

        //16 Day Forecast
        $("#weather16").on("click", function() {

            // This is our API key
            var weatherAPIKey = "166a433c57516f51dfab1f7edaed8413";

            var userCity = "minneapolis";

            // Here we are building the URL we need to query the database(Current Day)
            var weatherURLLong =    "https://api.openweathermap.org/data/2.5/forecast?q=" +
                                    userCity + "&units=imperial&appid=" + weatherAPIKey + "&cnt=16";

            // Here we run our AJAX call to the OpenWeatherMap API
            $.ajax ({
            url: weatherURLLong,
            method: "GET"
            })
                
            // We store all of the retrieved data inside of an object called "response"
            .then(function(response) {
                // Log the queryURL
                console.log("weatherURL: " + weatherURLLong);
                // Log the resulting object
                console.log(response);
                console.log("================================");
                
                var results = response.list;

                for (var i = 0; i < results.length; i++) {

                    var city = response.city.name
                    var date = results[i].dt_txt;
                    var temp = Math.floor(results[i].main.temp);
                    var sky = results[i].weather[0].main;
                    var image = results[i].weather[0].icon

                    console.log(city);
                    console.log(date);
                    console.log(temp + "째 F");
                    console.log(sky);
                    console.log(image);
                    console.log("================================");

                    var weatherDiv = $("<div>");
                    var weatherImage = $("<img>");
                    var weatherCity = $("<p>").text(city);
                    var weatherDay = $("<p>").text("Date: " + date);
                    var weatherSky = $("<p>").text("Sky: " + sky)
                    var weatherTemp = $("<p>").text("Temperature: " + temp + "째 F");

                    weatherImage.attr("src", "http://openweathermap.org/img/w/" + image + ".png")
                        
                    $("#description").append(weatherDiv);
                    weatherDiv.append(weatherCity);
                    weatherDiv.append(weatherDay);
                    weatherDiv.append(weatherSky);
                    weatherDiv.append(weatherTemp);
                    weatherDiv.append(weatherImage);
                }

            });
        });

    </script>
</body>
</html>